<template>
  <section class="text-forest-green bg-lint p-2">
    <Toolbar class="container p-0 bg-transparent border-none">
      <template #start>
        <nuxt-link class="flex" to="/">
          <svg class="mr-2" height="50px" width="50px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve">
            <g>
              <path style="fill: #478c5c" d="M252.293,432.283c-26.896,0-52.118-10.41-71.02-29.311L29.369,251.069
      c-39.159-39.16-39.159-102.879,0-142.04c18.902-18.902,44.124-29.313,71.02-29.313s52.118,10.41,71.02,29.313l24.37,24.37
      c5.135,5.135,5.136,13.461,0,18.596s-13.461,5.136-18.596,0l-24.371-24.37c-13.934-13.936-32.553-21.61-52.424-21.61
      s-38.49,7.674-52.423,21.608c-28.906,28.906-28.906,75.94,0,104.848l151.903,151.903c13.936,13.936,32.553,21.61,52.424,21.61
      s38.488-7.674,52.423-21.608c28.906-28.906,28.906-75.94,0-104.847c-5.135-5.135-5.135-13.461,0-18.597
      c5.136-5.135,13.46-5.135,18.597,0c18.901,18.902,29.311,44.124,29.311,71.02c0,26.896-10.41,52.118-29.311,71.02
      C304.411,421.873,279.189,432.283,252.293,432.283z" />
              <path style="fill: #478c5c" d="M189.359,315.175c-3.365,0-6.731-1.283-9.298-3.851c-5.135-5.135-5.135-13.461,0-18.597
      l33.009-33.009c5.135-5.135,13.461-5.135,18.597,0c5.135,5.135,5.135,13.461,0,18.597l-33.009,33.009
      C196.089,313.892,192.724,315.175,189.359,315.175z" />
              <path style="fill: #013a20" d="M130.316,256.133c-3.365,0-6.73-1.283-9.298-3.851c-5.135-5.135-5.136-13.461,0-18.596
      l33.008-33.009c5.135-5.135,13.461-5.136,18.596,0c5.135,5.136,5.136,13.461,0,18.596l-33.008,33.009
      C137.047,254.848,133.681,256.133,130.316,256.133z" />
              <path style="fill: #478c5c" d="M259.766,432.341c-25.72,0-51.44-9.79-71.02-29.369c-39.16-39.16-39.16-102.879,0-142.04
      L340.649,109.03c39.16-39.159,102.879-39.16,142.041,0c18.901,18.902,29.311,44.124,29.311,71.02s-10.41,52.118-29.311,71.02
      l-24.37,24.37c-5.136,5.136-13.46,5.136-18.597,0c-5.135-5.135-5.135-13.461,0-18.596l24.37-24.37
      c28.906-28.906,28.906-75.94,0-104.847c-28.905-28.906-75.942-28.904-104.847,0L207.342,279.528
      c-28.906,28.906-28.906,75.94,0,104.847c28.905,28.905,75.94,28.908,104.847,0c5.136-5.136,13.46-5.136,18.597,0
      c5.135,5.135,5.135,13.461,0,18.596C311.205,422.552,285.486,432.341,259.766,432.341z" />
            </g>
            <path style="fill: #cdd193" d="M275.466,192.81l-77.421,77.421c-33.946,33.946-33.946,89.496,0,123.442l0,0
    c33.946,33.946,89.496,33.946,123.442,0l77.422-77.421L275.466,192.81z" />
            <g>
              <path style="fill: #478c5c" d="M259.766,432.283c-26.896,0-52.118-10.41-71.02-29.311c-39.16-39.16-39.16-102.879,0-142.04
      l77.421-77.422c5.136-5.135,13.46-5.135,18.597,0l123.444,123.442c2.466,2.466,3.851,5.811,3.851,9.298
      c0,3.487-1.386,6.832-3.851,9.298l-77.422,77.421C311.884,421.873,286.662,432.283,259.766,432.283z M275.466,211.405
      l-68.123,68.124c-28.906,28.906-28.906,75.94,0,104.847c13.934,13.934,32.553,21.608,52.424,21.608
      c19.87,0,38.49-7.674,52.423-21.608l68.124-68.124L275.466,211.405z" />
              <path style="fill: #013a20" d="M322.699,315.175c-3.366,0-6.73-1.283-9.298-3.851l-33.008-33.009
      c-5.135-5.135-5.135-13.461,0-18.596c5.139-5.134,13.462-5.135,18.597,0l33.008,33.009c5.135,5.135,5.135,13.461,0,18.596
      C329.43,313.892,326.064,315.175,322.699,315.175z" />
              <path style="fill: #013a20" d="M381.744,256.133c-3.366,0-6.73-1.283-9.298-3.851l-33.009-33.009
      c-5.135-5.135-5.135-13.461,0-18.597c5.136-5.135,13.46-5.135,18.597,0l33.009,33.009c5.135,5.135,5.135,13.461,0,18.597
      C388.473,254.85,385.108,256.133,381.744,256.133z" />
            </g>
          </svg>
          <div>
            <h4 class="font-bold">SAG-BOL</h4>
            <p class="text-sm">Iň amatly bahadan tap!</p>
          </div>
        </nuxt-link>
      </template>
      <template #center>
        <div class="bg-lint-1 py-2.5 px-5 rounded-lg shadow-md font-bold">
          <i class="pi pi-map-marker"></i>
          Aşgabat
        </div>
      </template>
      <template #end>
        <ul class="flex">
          <li class="border-r border-forest-green px-2">
            <i class="pi pi-phone"></i>
            +99364028855
          </li>
          <li class="border-r border-forest-green px-2">
            <i class="pi pi-calendar"></i>
            Hepdede 7 gün işleýäris
          </li>
          <li class="px-2">
            <i class="pi pi-clock"></i>
            9:00-19:00
          </li>
        </ul>
      </template>
    </Toolbar>
  </section>
  <header class="p-2 text-forest-green sticky top-0 bg-white shadow-md z-10 transition-all duration-150 ease-in-out">
    <Toolbar class="container p-0 bg-transparent border-none relative">
      <template #start>
        <button
          class="py-2.5 px-5 rounded-lg bg-white transition-colors duration-150 ease-in-out hover:bg-lint-1 outline-none"
          :class="{ lint: isMenuVisible }" @click="openMenu">
          <i class="pi pi-th-large"></i>
          Kategoriýalar
        </button>
      </template>
      <template #center>
        <span class="flex items-center bg-search search-600 border rounded-xl px-5 relative">
          <InputText v-model="searchQuery" @keypress.enter="showSearchItems" type="text" placeholder="Gözleg ..."
            class="w-full border-none bg-search placeholder:text-forest-green text-forest-green" />
          <i class="pi pi-search" style="color: #478c5c"></i>
          <div v-if="searchData.length >= 1"
            class="bg-white absolute top-12 w-full left-0 overflow-y-scroll h-96 rounded">
            <searchItems :items="searchData"></searchItems>
          </div>
        </span>
      </template>

      <template #end>
        <ul class="flex gap-5">
          <li>
            <i class="pi pi-globe" style="font-size: 1.3rem; color: #478c5c"></i>
          </li>
          <li class="flex gap-1 cursor-pointer" @click="openSignInMenu">
            Içeri gir
            <i class="pi pi-sign-in" style="font-size: 1.3rem; color: #478c5c"></i>
          </li>
          <li class="flex gap-1">
            Sebet
            <i class="pi pi-shopping-cart" style="font-size: 1.3rem; color: #478c5c"></i>
          </li>
          <li class="flex gap-1 cursor-pointer" @click="openSidebar">
            Menýu
            <i class="pi pi-align-right" style="font-size: 1.3rem; color: #478c5c"></i>
          </li>
        </ul>
      </template>
    </Toolbar>

    <!-- Сategory -->
    <nav
      class="container flex absolute shadow-md py-10 overflow-y-scroll h-72 left-72 bg-white opacity-0 invisible transition-all duration-300 ease z-50"
      :class="{ 'opacity-100 !visible': isMenuVisible }">
      <ul class="flex flex-col gap-2 border-r px-5 relative">
        <nuxt-link @click="openMenu" :to="`/${category.category}`"
          class="flex justify-between items-center border rounded-md px-3 py-1 border-emerald-green hover:bg-lint-1"
          v-for="(category, index) in categories" :key="index" @mouseover="showSubmenu(index)">
          <span class="flex gap-1">
            <img :src="category.icon" alt="Category icon" />
            {{ category?.label }}
          </span>
          <i class="pi pi-chevron-right"></i>
          <ul v-if="isSubmenuVisible && index === activeIndex" class="flex flex-col gap-2 absolute left-80 top-0 w-full">
            <h1 class="text-xl font-bold">{{ category.label }}</h1>
            <nuxt-link :to="`/${category.category}/${subCategory.subcategory}`"
              v-for="(subCategory, subIndex) in category.items" :key="subIndex">
              {{ subCategory.title }}
            </nuxt-link>
          </ul>
        </nuxt-link>
      </ul>
    </nav>
    <!-- Sign in modal -->
    <SignIn :class="{ 'opacity-100 !visible': isSignInMenuOpen }" @close-menu="closeSignInMenu"></SignIn>
    <Sidebar :class="{ 'translate-x-0': isSidebarVisible }" @close-sidebar="closeSidebar" @open-sign-in="openSignInMenu"></Sidebar>
  </header>

  <slot />
  <footer class="bg-lint">
    <div class="container flex py-10">
      <div class="flex w-1/3">
        <svg class="mr-2" height="50px" width="50px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve">
          <g>
            <path style="fill: #478c5c" d="M252.293,432.283c-26.896,0-52.118-10.41-71.02-29.311L29.369,251.069
		c-39.159-39.16-39.159-102.879,0-142.04c18.902-18.902,44.124-29.313,71.02-29.313s52.118,10.41,71.02,29.313l24.37,24.37
		c5.135,5.135,5.136,13.461,0,18.596s-13.461,5.136-18.596,0l-24.371-24.37c-13.934-13.936-32.553-21.61-52.424-21.61
		s-38.49,7.674-52.423,21.608c-28.906,28.906-28.906,75.94,0,104.848l151.903,151.903c13.936,13.936,32.553,21.61,52.424,21.61
		s38.488-7.674,52.423-21.608c28.906-28.906,28.906-75.94,0-104.847c-5.135-5.135-5.135-13.461,0-18.597
		c5.136-5.135,13.46-5.135,18.597,0c18.901,18.902,29.311,44.124,29.311,71.02c0,26.896-10.41,52.118-29.311,71.02
		C304.411,421.873,279.189,432.283,252.293,432.283z" />
            <path style="fill: #478c5c" d="M189.359,315.175c-3.365,0-6.731-1.283-9.298-3.851c-5.135-5.135-5.135-13.461,0-18.597
		l33.009-33.009c5.135-5.135,13.461-5.135,18.597,0c5.135,5.135,5.135,13.461,0,18.597l-33.009,33.009
		C196.089,313.892,192.724,315.175,189.359,315.175z" />
            <path style="fill: #013a20" d="M130.316,256.133c-3.365,0-6.73-1.283-9.298-3.851c-5.135-5.135-5.136-13.461,0-18.596
		l33.008-33.009c5.135-5.135,13.461-5.136,18.596,0c5.135,5.136,5.136,13.461,0,18.596l-33.008,33.009
		C137.047,254.848,133.681,256.133,130.316,256.133z" />
            <path style="fill: #478c5c" d="M259.766,432.341c-25.72,0-51.44-9.79-71.02-29.369c-39.16-39.16-39.16-102.879,0-142.04
		L340.649,109.03c39.16-39.159,102.879-39.16,142.041,0c18.901,18.902,29.311,44.124,29.311,71.02s-10.41,52.118-29.311,71.02
		l-24.37,24.37c-5.136,5.136-13.46,5.136-18.597,0c-5.135-5.135-5.135-13.461,0-18.596l24.37-24.37
		c28.906-28.906,28.906-75.94,0-104.847c-28.905-28.906-75.942-28.904-104.847,0L207.342,279.528
		c-28.906,28.906-28.906,75.94,0,104.847c28.905,28.905,75.94,28.908,104.847,0c5.136-5.136,13.46-5.136,18.597,0
		c5.135,5.135,5.135,13.461,0,18.596C311.205,422.552,285.486,432.341,259.766,432.341z" />
          </g>
          <path style="fill: #cdd193" d="M275.466,192.81l-77.421,77.421c-33.946,33.946-33.946,89.496,0,123.442l0,0
	c33.946,33.946,89.496,33.946,123.442,0l77.422-77.421L275.466,192.81z" />
          <g>
            <path style="fill: #478c5c" d="M259.766,432.283c-26.896,0-52.118-10.41-71.02-29.311c-39.16-39.16-39.16-102.879,0-142.04
		l77.421-77.422c5.136-5.135,13.46-5.135,18.597,0l123.444,123.442c2.466,2.466,3.851,5.811,3.851,9.298
		c0,3.487-1.386,6.832-3.851,9.298l-77.422,77.421C311.884,421.873,286.662,432.283,259.766,432.283z M275.466,211.405
		l-68.123,68.124c-28.906,28.906-28.906,75.94,0,104.847c13.934,13.934,32.553,21.608,52.424,21.608
		c19.87,0,38.49-7.674,52.423-21.608l68.124-68.124L275.466,211.405z" />
            <path style="fill: #013a20" d="M322.699,315.175c-3.366,0-6.73-1.283-9.298-3.851l-33.008-33.009
		c-5.135-5.135-5.135-13.461,0-18.596c5.139-5.134,13.462-5.135,18.597,0l33.008,33.009c5.135,5.135,5.135,13.461,0,18.596
		C329.43,313.892,326.064,315.175,322.699,315.175z" />
            <path style="fill: #013a20" d="M381.744,256.133c-3.366,0-6.73-1.283-9.298-3.851l-33.009-33.009
		c-5.135-5.135-5.135-13.461,0-18.597c5.136-5.135,13.46-5.135,18.597,0l33.009,33.009c5.135,5.135,5.135,13.461,0,18.597
		C388.473,254.85,385.108,256.133,381.744,256.133z" />
          </g>
        </svg>
        <span class="flex flex-col">
          <h3 class="font-bold">SAG-BOL</h3>
          <p>Iň amatly bahadan tap!</p>
        </span>
      </div>

      <nav class="flex justify-between flex-1">
        <ul>
          <h1 class="font-bold text-lg mb-1">Biz barada</h1>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            Biz barada
          </li>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            Eltip bermek we tölemek
          </li>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            Sargyt etmek
          </li>
          <li class="text-md hover:text-emerald-green transition-colors ease-in-out">
            Sorag jogap
          </li>
        </ul>

        <ul>
          <h1 class="font-bold text-lg mb-1">Hyzmatdaşlyk</h1>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            Hyzmatdaşlyk
          </li>
          <li class="text-md hover:text-emerald-green transition-colors ease-in-out">
            Markalar
          </li>
        </ul>

        <ul>
          <h1 class="font-bold text-lg mb-1">Ulanuş düzgünleri</h1>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            Ulanyş düzgünleri
          </li>
          <li class="text-md hover:text-emerald-green transition-colors ease-in-out">
            Gizlinlik ýörelgesi
          </li>
        </ul>

        <ul>
          <h1 class="font-bold text-lg">Kömek</h1>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            Kömek we goldaw
          </li>
          <li class="text-md mb-1 hover:text-emerald-green transition-colors ease-in-out">
            E-poçtalarymyz
          </li>
          <li class="text-md hover:text-emerald-green transition-colors ease-in-out">
            Habarlaşmak
          </li>
        </ul>
      </nav>
    </div>
    <div class="text-center border-t border-forest-green py-4">
      <p class="text-sm">
        @ Ähli hukuklar goraglydyr - {{ footerYear }}. SAG-BOL.com
      </p>
    </div>
  </footer>
</template>

<script>
export default {
  data() {
    return {
      isSidebarVisible: false,
      isSignInMenuOpen: useIsSignInMenuVisible(),
      isSearchItemsVisible: false,
      searchQuery: "",
      searchItems: useAll(),
      categories: categories(),
      isMenuVisible: useIsMenuVisible(),
      isSubmenuVisible: false,
      activeIndex: null,
    };
  },
  computed: {
    footerYear() {
      let data = new Date().getFullYear();
      return data;
    },
    searchData() {
      const data = this.searchItems.filter((item) =>
        item.queries.includes(this.searchQuery)
      );
      return data;
    },
  },
  methods: {
    openMenu() {
      this.isMenuVisible = !this.isMenuVisible;
    },
    showSubmenu(index) {
      this.isSubmenuVisible = true;
      this.activeIndex = index;
    },
    hideMenu() {
      this.isMenuVisible = !this.isMenuVisible;
    },
    showSearchItems() {
      this.isSearchItemsVisible = !this.isSearchItemsVisible;
    },
    openSignInMenu() {
      this.isSignInMenuOpen = !this.isSignInMenuOpen;
    },
    closeSignInMenu() {
      this.isSignInMenuOpen = false;
    },
    openSidebar() {
      this.isSidebarVisible = true;
    },
    closeSidebar() {
      this.isSidebarVisible = false;
    }
  },
};
</script>
